## 진행자 유경의 잔혹한 질문 폭탄

# 1. 호이스팅이 일어나는 과정을 실행 컨텍스트를 근거로 설명해주세요. 이때 var키워드로 선언하는 것과 let, const키워드로 선언하는 것을 구분해주세요.

## 1) 실행 컨텍스트가 생성되는 시점이 언제인가요?

### 민영

→ 실행 컨텍스트가 자바스크립트 코드가 실행될 때 생성되는 걸로 알고 있습니다. 그리고 실행 컨텍스트가 생성되는 단계가 평가랑 실행 단계로 나눠지는 걸로 알고 있습니다.

### 모범답안

실행 컨텍스트는 자바스크립트 코드가 실행될 때마다 생성됩니다. (소스코드가 실행될 때 생성된다.)

### 2) 실행 컨텍스트의 구성요소 중 렉시컬 환경에 대해서 말씀해주세요.

### 보경

그림을 아무리 봐도 이해가 잘 안되가지고 일단 나와있는 렉시컬 환경의 정의만 말씀드려보면 식별자하고 식별자에 바인딩 된 값, 그리고 상위 스코프에 대한 참조를 기록하는 자료구조로, 실행 컨텍스트를 구성하는 컴포넌트이구요, 체인 컨텍스트 스택이 코드 순서를 관리한다면 이건 스코프와 식별자를 관리하는 개념입니다.

### 모범 답안

렉시컬 환경: 식별자에 대한 정보와 상위 스코프에 대한 정보를 가지고 있는 실행 컨텍스트의 컴포넌트이다.

- 환경 레코드 : 식별자와 식별자에 바인딩된 값이 키와 값 형태의 객체로 이루어져 있고
- 외부 렉시컬 환경에 대한 참조 : 상위 스코프에 대한 정보

### 3) var키워드와 let, const키워드의 렉시컬 환경의 차이를 말씀해주세요

## 지원

var 키워드는 객체 환경 레코드에 선언이 되고, let과 const는 해당 블록의 const로 선언된 경우에는 선언과 동시에 초기화가 이루어져야 하고, 재할당이 불가능합니다.

## 민영

우선 var 키워드는 함수 레벨 스코프를 가지기 때문에 호이스팅이 발생하고, 호이스팅이 발생하는 동시에 초기화도 이루어집니다. 근데 그에 반해 let과 const 키워드는 블록레벨 스코프를 가지기 때문에 var처럼 호이스팅은 되지만 let은 초기화가 선언 위치에서 이루어지고, const는 선언과 동시에 초기화가 필요한 걸로 알고 있습니다.

→ 보완 : let과 const가 TDZ(일시적 사각지대)에 놓이기 때문에 let이랑 const로 선언한 변수가 초기화 되기 전까지 접근을 할 수 없다.

## 보경

스코프를 다르게 가지고 있잖아요. 이걸 구분하기 위해서는 이제 전역 스코프의 역할을 하는 전역 환경 레코드에 대해 알고 넘어가야할 텐데 전역 환경 레코드에 대한 설명을 건너뛰고 말씀 드리자면, 객체 환경 레코드와 선언적 환경 레코드로 구성되어 있고, 선언문은 코드 평가 단계에서 먼저 평가되고 생성된다고 알고 있잖아요 저희가, 평가 과정에서 var키워드로 선언한 전역 변수와 플러스 알파들은 Binding.Object를 통해서 전역 객체의 프로퍼티와 메서드가 되고, let과 const 키워드로 선언한 변수들은 평가 단계에서 선언적 환경 레코드에 등록되서 다른 스코프를 가지게 됩니다.

### 모범 답안

- var키워드로 선언한 변수 및 함수 등은 전역 객체의 프로퍼티로 연결하기 위해 전역 실행 컨텍스트의 전역 렉시컬 환경의 환경 레코드에 등록됩니다. 이때 환경 레코드 중에서도 객체 환경 레코드에 등록됩니다.
- 이와 다르게 let, const키워드로 선언한 변수 및 함수 등은 전역 환경 레코드 중에서도 선언적 환경 레코드에 저장되어 전역 변수와는 다른 스코프를 가지게 됩니다.

<br />

# 렉시컬 스코프가 결정되는 과정을 실행 컨텍스트를 근거로 설명해주세요.

** 키워드 컨닝 가능합니다. **

## 1) 렉시컬 스코프가 무엇인가요?

## 지원

함수가 선언된 위치에 따라서 스코프가 결정되는 것 입니다.

### 모범 답안

렉시컬 스코프란 코드가 정의된 위치에 따라 스코프가 결정되는 것 입니다.

## 2) 렉시컬 스코프와 관련이 있는 실행 컨텍스트의 구성 요소가 무엇인가요?

### 모범 답안

렉시컬 환경 중에서도 외부 렉시컬 환경에 대한 참조가 스코프와 관련된 정보를 가지고 있기 때문에 렉시컬 스코프와 관련이 있습니다.

## 3) 렉시컬 스코프는 언제 결정될까요?

### 모범 답안

정의된 위치를 자바스크립트 엔진이 알기 위해서 정의된 위치는 선언한 위치와 동일한 의미이고 이는 즉, 소스코드의 평가 단계에서 전역 렉시컬 환경에 등록되게 됩니다.
-> 이때 렉시컬 스코프도 렉시컬 환경에 의해 결정되게 됩니다.

# 최종 질문에 대한 모범 답변

## 답변하기 위한 기반 개념

- 렉시컬 스코프 : 코드가 정의된 위치에 따라 스코프가 정해지는 것
- 실행 컨텍스트 : 코드가 실행되는 환경
  - 각각의 실행 컨텍스트는 렉시컬 환경을 포함하고 있음
- 렉시컬 환경 : 현재 실행 중인 코드의 식별자와 변수, 함수 선언 등을 저장하는 환경
  - 환경 레코드 (Environment Record) : 현재 스코프 내의 모든 식별자에 대한 정보를 기록
  - 외부 렉시컬 환경에 대한 참조(Outer Lexical Environment Reference) : 현재 코드 블록을 둘러싼 외부 환경으로 상위 스코프

### 렉시컬 스코프 결정 과정

렉시컬 스코프는 함수가 정의될 때 결정 됨

함수는 자신이 정의된 위치의 렉시컬 환경을 기억하고, 함수가 호출될 때 그 렉시컬 환경에 대한 참조를 이용해 변수를 검색

- <u>**함수 정의 시점**</u> <br />
  함수가 정의될 때 자바스크립트 엔진은 해당 함수의 렉시컬 환경을 설정한다.
  함수가 정의된 위치의 환경 레코드 포함하고, 외부 렉시컬 환경에 대한 참조도 설정 됨
- <u>**함수 호출 시점**</u> <br />
  새로운 실행 컨텍스트가 생성되고, 이 컨텍스트는 함수의 렉시컬 환경을 가리 킴
  호출된 함수는 이 렉시컬 환경을 통해 변수와 함수 선언 등을 참조한다.
  만약 렉시컬 환경에 검색한 변수가 없으면 외부 렉시컬 환경에 대한 참조를 따라 상위 스코프로 올라가며 변수를 검색함

### 결론

렉시컬 환경은 함수나 블록이 정의될 때 결정이 된다. 이를 참고하여 함수 호출 시점에 동작하기 때문에 렉시컬 스코프는 함수가 정의되는 위치에 따라서 결정된다.
